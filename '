package chess;

import java.util.Scanner;

public class ChessGame {
    private boolean newGame = false;
    private boolean whiteTurn = true;
	private Board board = new Board();
    private Scanner sc = new Scanner(System.in);

	public static void main(String[] args) {	
		boolean exit = false;
		String command = "";

		System.out.println("Welcome to Console Chess!");
		System.out.println("Enter your commands or 'help' for help: ");
        newGame();

		do {
            if (sc.hasNext()) {
                command = sc.next().trim();
                exit = handleCommand(command);
            } else {
                System.out.println();
            }
		} while(!exit);
	}

	private static boolean handleConsoleInput(String inputString) {
        if (inputString.equals("newGame")) {
           newGame();
        } else if (inputString.equals("printBoard")) {
			printBoard();
        } else if (inputString.equals("help")) {
            System.out.println("Currently no help. Whoops.");
        } else if (inputString.equals("move")) {
			// TODO: Will be prone to user errors that crash program
			int oldX = sc.nextInt();
			int oldY = sc.nextInt();
			int newX = sc.nextInt();
			int newY = sc.nextInt();
			movePiece(oldX, oldY, newX, newY);
        } else if (inputString.equals("exit")) {
            System.out.println("Console Chess will now exit.");
            return true;
        }
		return false;
	}

    private static void newGame() {
        board.resetBoard();
        isNewGame = true;
        isWhiteTurn = true;
        System.out.println("\nYou've started a new game, white goes first.\n");
        System.out.println(board.toString() + "\n");
    }

	private static void printBoard() {
		System.out.println(board.toString() + "\n");
	}

    private static void movePiece(int oldX, int oldY, int newX, int newY) {
        if (!(board.getPiece(oldX, oldY).isWhite() ^ whiteTurn)) {
			boolean moveSuccess = board.movePiece(oldX, oldY, newX, newY);
			if (moveSuccess) {
				whiteTurn = whiteTurn ? false : true;
			} else {
				System.out.println("That is an illegal move.");
			}
		} else {
			System.out.println("It is not %s turn.",
					whiteTurn ? "white's" : "black's");
		}
	}
}
